import{Q as J}from"./QpPage.d0ca4417.js";import{_ as H,k as O,m as h,p as P,r as a,o as V,c as $,w as o,b as t,a as p,t as T,u as y,q as N,v as K,x as W,y as S,j as k,E as Y,z as q,A as B,B as z,C as ee,D as te,F as Q,e as oe,g as le}from"./index.95932bff.js";const D=R=>(ee("data-v-c1571068"),R=R(),te(),R),se=["textContent"],ne=["innerHTML"],ae=["textContent"],re=["textContent"],ie=D(()=>p("div",null,"(en d\xE9veloppement)",-1)),ue=D(()=>p("div",null,"(en d\xE9veloppement)",-1)),de=D(()=>p("div",null,"(en d\xE9veloppement)",-1)),me={__name:"RegisterView",setup(R){const{t:e}=O(),c=h(!1),v=h(),_=h(!1),f=h(!1),w=h(!1),g=h(),r=P({username:"",email:"",name:"",password:"",password_confirm:""}),b=(s,l,n)=>{const m=/^[A-Za-z0-9_-]+$/;l===""?n(new Error(e("Thisfieldisrequired"))):l.match(m)?n():n(new Error(e("Mustonlycontainlettersnumbersandsomecharacters")))},U=(s,l,n)=>{const m=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;l===""?n(new Error(e("Thisfieldisrequired"))):l.match(m)?n():n(new Error(e("Thisemailisinvalid")))},E=(s,l,n)=>{const m=/^[A-Za-z- ]+$/;l===""?n(new Error(e("Thisfieldisrequired"))):l.match(m)?n():n(new Error(e("Mustonlycontainlettersspaceandsomecharacters")))},i=(s,l,n)=>{l===""?n(new Error(e("Thisfieldisrequired"))):l!==r.password?n(new Error(e("Thepasswordconfirmationdoesntmatch"))):n()},d=P({username:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:5,max:150,message:e("LengthshouldbebetweenXandX",[5,150]),trigger:"blur"},{validator:b,trigger:"blur"}],email:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:8,max:254,message:e("LengthshouldbebetweenXandX",[8,254]),trigger:"blur"},{validator:U,trigger:"blur"}],name:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:2,max:32,message:e("LengthshouldbebetweenXandX",[2,32]),trigger:"blur"},{validator:E,trigger:"blur"}],password:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:8,max:254,message:e("LengthshouldbebetweenXandX",[6,254]),trigger:"blur"}],password_confirm:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:8,max:254,message:e("LengthshouldbebetweenXandX",[6,254]),trigger:"blur"},{validator:i,trigger:"blur"}]}),L=async()=>{c.value=!0,v.value=null,await g.value.validate(s=>{s?Y.confirm(q("div",null,[q("p",null,e("Byclickingyouacceptrules")),q("div",{class:"qp-center"},[q("button",{class:"el-button is-text",onClick:()=>{_.value=!0}},e("ReadTheRules"))]),q("div",{class:"qp-center"},[q("button",{class:"el-button is-text",onClick:()=>{f.value=!0}},e("ReadUsePolicies"))]),q("div",{class:"qp-center"},[q("button",{class:"el-button is-text",onClick:()=>{w.value=!0}},e("ReadPrivacyPolicies"))])]),e("Register"),{confirmButtonText:e("IAcceptTheRules"),cancelButtonText:e("Cancel"),autofocus:!1,closeOnClickModal:!1,closeOnPressEscape:!1,closeOnHashChange:!1}).then(()=>{x()}).catch(()=>{c.value=!1}):c.value=!1})},x=async()=>{c.value=!0,v.value=null;let s=new FormData;s.append("username",r.username.trim()),s.append("email",r.email.trim()),s.append("name",r.name.trim()),s.append("password",r.password);let l=await fetch(`${B}/register/`,{method:"POST",body:s});l.status===200?A({name:"AuthLogin"}):l.status===400?(v.value=e("InvalidCredentials"),c.value=!1):(v.value=e("AnErrorOccurred"),c.value=!1)},A=s=>{z.push(s)};return(s,l)=>{const n=a("el-input"),m=a("el-form-item"),M=a("el-alert"),C=a("el-button"),F=a("el-form"),j=a("el-card"),X=a("el-scrollbar"),I=a("el-dialog"),Z=a("el-col"),G=a("el-row");return V(),$(G,{id:"qp-auth-register"},{default:o(()=>[t(Z,null,{default:o(()=>[t(j,null,{default:o(()=>[p("h1",{textContent:T(s.$t("Register"))},null,8,se),t(F,{ref_key:"refRegister",ref:g,model:r,rules:d,"label-position":"top","status-icon":""},{default:o(()=>[t(m,{prop:"username"},{default:o(()=>[t(n,{modelValue:r.username,"onUpdate:modelValue":l[0]||(l[0]=u=>r.username=u),placeholder:s.$t("Username"),"prefix-icon":y(N)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),t(m,{prop:"email"},{default:o(()=>[t(n,{modelValue:r.email,"onUpdate:modelValue":l[1]||(l[1]=u=>r.email=u),placeholder:s.$t("Email"),"prefix-icon":y(K)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),t(m,{prop:"name"},{default:o(()=>[t(n,{modelValue:r.name,"onUpdate:modelValue":l[2]||(l[2]=u=>r.name=u),placeholder:s.$t("Name"),"prefix-icon":y(W)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),t(m,{prop:"password"},{default:o(()=>[t(n,{modelValue:r.password,"onUpdate:modelValue":l[3]||(l[3]=u=>r.password=u),placeholder:s.$t("Password"),"prefix-icon":y(S),type:"password"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),t(m,{prop:"password_confirm"},{default:o(()=>[t(n,{modelValue:r.password_confirm,"onUpdate:modelValue":l[4]||(l[4]=u=>r.password_confirm=u),placeholder:s.$t("PasswordConfirm"),"prefix-icon":y(S),type:"password"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),v.value?(V(),$(m,{key:0},{default:o(()=>[t(M,{type:"error","show-icon":"",closable:!1},{default:o(()=>[p("div",{innerHTML:v.value},null,8,ne)]),_:1})]),_:1})):k("",!0),t(m,{class:"qp-form-submit"},{default:o(()=>[t(C,{type:"primary",loading:c.value,onClick:l[5]||(l[5]=u=>L())},{default:o(()=>[p("span",{textContent:T(s.$t("RegisterMe"))},null,8,ae)]),_:1},8,["loading"])]),_:1}),t(m,{class:"qp-form-switchauth"},{default:o(()=>[t(C,{text:"",size:"small",disabled:c.value,onClick:l[6]||(l[6]=u=>A({name:"AuthLogin"}))},{default:o(()=>[p("span",{textContent:T(s.$t("Alreadyhaveanaccount"))},null,8,re)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),t(I,{modelValue:_.value,"onUpdate:modelValue":l[7]||(l[7]=u=>_.value=u),title:y(e)("TheRules")},{default:o(()=>[t(X,{height:"60vh"},{default:o(()=>[ie]),_:1})]),_:1},8,["modelValue","title"]),t(I,{modelValue:f.value,"onUpdate:modelValue":l[8]||(l[8]=u=>f.value=u),title:y(e)("UsePolicies")},{default:o(()=>[t(X,{height:"60vh"},{default:o(()=>[ue]),_:1})]),_:1},8,["modelValue","title"]),t(I,{modelValue:w.value,"onUpdate:modelValue":l[9]||(l[9]=u=>w.value=u),title:y(e)("PrivacyPolicies")},{default:o(()=>[t(X,{height:"60vh"},{default:o(()=>[de]),_:1})]),_:1},8,["modelValue","title"])]),_:1})]),_:1})}}},pe=H(me,[["__scopeId","data-v-c1571068"]]);const ce=["textContent"],_e=["innerHTML"],fe=["textContent"],ge=["textContent"],he={__name:"LoginView",setup(R){const{t:e}=O(),c=Q(),{updateRat:v}=c,_=h(!1),f=h(),w=h(),g=P({username:"",password:""}),r=P({username:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:5,max:150,message:e("LengthshouldbebetweenXandX",[5,150]),trigger:"blur"}],password:[{required:!0,message:e("Thisfieldisrequired"),trigger:"blur"},{min:8,max:254,message:e("LengthshouldbebetweenXandX",[6,254]),trigger:"blur"}]}),b=async()=>{_.value=!0,f.value=null,await w.value.validate(i=>{i?U():_.value=!1})},U=async()=>{_.value=!0;let i=new FormData;i.append("username",g.username),i.append("password",g.password);let d=await fetch(`${B}/login/`,{method:"POST",body:i});if(d.status===200){let L=await d.json();v(L.token),E({name:"Home"})}else d.status===400?(f.value=e("InvalidCredentials"),_.value=!1):(f.value=e("AnErrorOccurred"),_.value=!1)},E=i=>{z.push(i)};return(i,d)=>{const L=a("el-input"),x=a("el-form-item"),A=a("el-alert"),s=a("el-button"),l=a("el-form"),n=a("el-card"),m=a("el-col"),M=a("el-row");return V(),$(M,{id:"qp-auth-login"},{default:o(()=>[t(m,null,{default:o(()=>[t(n,null,{default:o(()=>[p("h1",{textContent:T(i.$t("Login"))},null,8,ce),t(l,{ref_key:"refLogin",ref:w,model:g,rules:r,"label-position":"top","status-icon":""},{default:o(()=>[t(x,{prop:"username"},{default:o(()=>[t(L,{modelValue:g.username,"onUpdate:modelValue":d[0]||(d[0]=C=>g.username=C),placeholder:i.$t("Username"),"prefix-icon":y(N)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),t(x,{prop:"password"},{default:o(()=>[t(L,{modelValue:g.password,"onUpdate:modelValue":d[1]||(d[1]=C=>g.password=C),placeholder:i.$t("Password"),"prefix-icon":y(S),type:"password"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1}),f.value?(V(),$(A,{key:0,type:"error","show-icon":"",closable:!1},{default:o(()=>[p("p",{innerHTML:f.value},null,8,_e)]),_:1})):k("",!0),t(x,{class:"qp-form-submit"},{default:o(()=>[t(s,{type:"primary",loading:_.value,onClick:d[2]||(d[2]=C=>b())},{default:o(()=>[p("span",{textContent:T(i.$t("LoginMe"))},null,8,fe)]),_:1},8,["loading"])]),_:1}),t(x,{class:"qp-form-switchauth"},{default:o(()=>[t(s,{text:"",size:"small",disabled:_.value,onClick:d[3]||(d[3]=C=>E({name:"AuthRegister"}))},{default:o(()=>[p("span",{textContent:T(i.$t("Donthaveanaccount"))},null,8,ge)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}}},ve=H(he,[["__scopeId","data-v-1cfbd62d"]]);const we=["textContent"],be=["innerHTML"],ye={class:"qp-form-submit"},Ve=["textContent"],$e={__name:"LogoutView",setup(R){const{t:e}=O(),c=Q(),{rat:v}=oe(c),{cleanUser:_}=c,f=h(!1),w=h(),g=async()=>{f.value=!0;let b=await fetch(`${B}/logout/`,{method:"POST",headers:new Headers({Authorization:`Token ${v.value}`}),body:null});[204,401].includes(b.status)?(_(),r({name:"Home"})):(w.value=e("AnErrorOccurred"),f.value=!1)},r=b=>{z.push(b)};return le(()=>{g()}),(b,U)=>{const E=a("el-alert"),i=a("el-button"),d=a("el-card"),L=a("el-col"),x=a("el-row");return V(),$(x,{id:"qp-auth-logout"},{default:o(()=>[t(L,null,{default:o(()=>[t(d,{class:"qp-center"},{default:o(()=>[p("h1",{textContent:T(b.$t("Logout"))},null,8,we),w.value?(V(),$(E,{key:0,type:"error","show-icon":"",closable:!1},{default:o(()=>[p("p",{innerHTML:w.value},null,8,be)]),_:1})):k("",!0),p("div",ye,[t(i,{type:"primary",loading:f.value,onClick:U[0]||(U[0]=A=>g())},{default:o(()=>[p("span",{textContent:T(b.$t("LogoutMe"))},null,8,Ve)]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1})}}},Le=H($e,[["__scopeId","data-v-df5e82e9"]]);const xe={class:"qp-container qp-centered"},Te={__name:"AuthView",setup(R){return(e,c)=>(V(),$(J,null,{default:o(()=>[p("div",xe,[e.$route.name&&e.$route.name=="AuthRegister"?(V(),$(pe,{key:0})):e.$route.name&&e.$route.name=="AuthLogin"?(V(),$(ve,{key:1})):e.$route.name&&e.$route.name=="AuthLogout"?(V(),$(Le,{key:2})):k("",!0)])]),_:1}))}};export{Te as default};
